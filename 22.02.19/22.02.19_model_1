{"cells":[{"cell_type":"markdown","metadata":{"id":"I_iELta4J5NT"},"source":["# 디렉토리 설정 "]},{"cell_type":"markdown","source":[""],"metadata":{"id":"IYLfQA3WvHfW"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"25gmHRCYEzmf"},"outputs":[],"source":["!unzip /content/drive/MyDrive/DataSet/KYR_B_imaging.zip\n","!cp '/content/drive/MyDrive/Colab Notebooks/CT분류프로젝트/Custom_Py/init.py' ./"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3T5U1_vVWqS8"},"outputs":[],"source":["!cp -r '/content/KYR_B_imaging/20201224 DL_MRI_SNSB_임승욱/swr3' '/content/KYR_B_imaging' \n","!cp -r '/content/KYR_B_imaging/20201224 DL_MRI_SNSB_임승욱/swr2 74' '/content/KYR_B_imaging' \n","!cp -r '/content/KYR_B_imaging/20201224 DL_MRI_SNSB_임승욱/swr5' '/content/KYR_B_imaging' \n","!cp -r '/content/KYR_B_imaging/20201224 DL_MRI_SNSB_임승욱/swr1' '/content/KYR_B_imaging' \n","!cp -r '/content/KYR_B_imaging/20201224 DL_MRI_SNSB_임승욱/swr7' '/content/KYR_B_imaging' \n","!cp -r '/content/KYR_B_imaging/20201224 DL_MRI_SNSB_임승욱/swr8' '/content/KYR_B_imaging' \n","!cp -r '/content/KYR_B_imaging/20201224 DL_MRI_SNSB_임승욱/swr4' '/content/KYR_B_imaging' \n","!cp -r '/content/KYR_B_imaging/20201224 DL_MRI_SNSB_임승욱/nswr1' '/content/KYR_B_imaging' \n","!cp -r '/content/KYR_B_imaging/20201224 DL_MRI_SNSB_임승욱/swr6' '/content/KYR_B_imaging' \n","!rm -r '/content/KYR_B_imaging/20201224 DL_MRI_SNSB_임승욱'"]},{"cell_type":"markdown","metadata":{"id":"zcZ1__VY3jdO"},"source":["# 초기작업"]},{"cell_type":"markdown","metadata":{"id":"4vWmiBmR0ege"},"source":["## 기본 DF 생성 "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rosYzDen1l6T"},"outputs":[],"source":["import os \n","import cv2 \n","import pandas as pd \n","from glob import glob\n","from tqdm import tqdm\n","from init import init #초기 설정용 커스텀 패키지 \n","import numpy as np \n","import matplotlib.pyplot as plt \n","import matplotlib.pyplot as cm \n","import warnings\n","warnings.filterwarnings('ignore')"]},{"cell_type":"markdown","metadata":{"id":"DdMMgGvZ3iDe"},"source":["###snsb_df 생성 "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZJy_JgMFUqUQ"},"outputs":[],"source":["columns = ['성명',\n"," '병록번호',\n"," '만나이',\n"," '검사일',\n"," '교육년수',\n"," 'SVLT_recall_total_score_z',\n"," 'SVLT_Delayed_recall_z',\n"," 'SVLT_recognition_score_z',\n"," 'RCFT_immediate_recall_z',\n"," 'RCFT_delayed_recall_z',\n"," 'RCFT_recognition_score_z',\n"," 'K_MMSE_total_score_z',\n"," 'SNSB_II_Domain_Attention_z',\n"," 'SNSB_II_Domain_Language_z',\n"," 'SNSB_II_Domain_Visuospatial_z',\n"," 'SNSB_II_Domain_Memory_z',\n"," 'SNSB_II_Domain_Frontal_z']\n","\n","snsb_df = pd.read_csv('/content/drive/MyDrive/DataSet/202202_김예림/SNSB_integerated.csv')\n","snsb_df = snsb_df.drop([2098,2591]) #병록번호 없는 행 제거 <- 결측치 \n","snsb_df['병록번호'] = snsb_df['병록번호'].apply(lambda x : str(int(x))) #소수점으로 되어 있는 것 처리하고 str형 변형 \n","\n","snsb_df = snsb_df[columns]"]},{"cell_type":"markdown","metadata":{"id":"V7h0NIEotoIc"},"source":["###dir_df 생성 "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kerrOcyYidyv"},"outputs":[],"source":["#폴더 디렉토리\n","folder_dir = glob('/content/KYR_B_imaging/*')\n","dir_df = init.dir_df(folder_dir)\n","dir_df = dir_df.sort_values(by=['key','dir'])\n","dir_df = dir_df.reset_index().drop(columns = 'index')"]},{"cell_type":"markdown","metadata":{"id":"D2-wVYErkt2_"},"source":["### 병록번호- key 값 보정\n","- 자리수 다 다른거, 중복인거 보정 \n","- 9자리로 통일 "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IlQnCKnF06He"},"outputs":[],"source":["target_length = [4,5,6,7,8] #<- 수정해야 하는 병록번호 갯수들 \n","\n","dir_df,snsb_df = init.key_mismatch(dir_df,snsb_df,target_length)\n","#인덱스 초기화 \n","dir_df = dir_df.reset_index().drop(columns = 'index')\n","# plt.hist(snsb_df['병록번호'].map(len))\n","# plt.show()\n","\n","#에러값들 제외 \n","errors = ['000758836-1' '030338456-1' '040145556-1' '050236926-1' '090374796-1'\n"," '100402746-1' '120010356-1' '870133669-1' '920033543-1' '930236559-1'\n"," '930257597-1' '970682600-1']\n","\n","dir_df = dir_df.drop(np.where(dir_df['key'].map(len)>9)[0])"]},{"cell_type":"markdown","metadata":{"id":"8s0QWgYB5fLR"},"source":["## new_dir_df 생성 - 이미지 장수 통일 \n"]},{"cell_type":"markdown","source":["### key 값 별 이미지 장수 연산 "],"metadata":{"id":"b0iCEN_oc40h"}},{"cell_type":"code","source":["#이미지 장수 연산 \n","keys = list(set(dir_df['key'])) \n","images_length = pd.DataFrame(keys)[0].apply(lambda x: init.check_images(dir_df,x)) #키 값별로 이미지의 장수들 계산 \n","# images_length.value_counts()\n","\n","length_df = pd.DataFrame([keys,images_length]).T\n","length_df.columns = ['key','image_length']\n","length_df['image_length']  = length_df['image_length'].map(int)\n","\n","#Standard를 기준으로 less over 분할 \n","standard = 19 # 통일 시킬 이미지 장 수 기준 \n","\n","# 조정이 필요한 장 수 초과하는 것들만 추림 \n","length_df_over = length_df[length_df['image_length']>standard]\n","\n","#19장 보다 적은 경우 \n","# length_df_less = length_df[length_df['image_length']<standard]\n","\n","len(length_df_over)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tJ0qOVhtjdjK","executionInfo":{"status":"ok","timestamp":1645196976472,"user_tz":-540,"elapsed":4111,"user":{"displayName":"­임훈","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"15355961264808837253"}},"outputId":"61a2ec9f-2587-4169-a955-cddda8865068"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1606"]},"metadata":{},"execution_count":58}]},{"cell_type":"markdown","metadata":{"id":"KiMO161I-boA"},"source":["### key값 별로 이미지 19장 있는 new_dir_df 생성 "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7550,"status":"ok","timestamp":1645196985636,"user":{"displayName":"­임훈","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"15355961264808837253"},"user_tz":-540},"id":"W0T5XeyUeyOm","outputId":"da71438c-3164-4a62-dc04-2ce755257238"},"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 1606/1606 [00:07<00:00, 212.05it/s]\n"]}],"source":["new_dir_df = pd.DataFrame(np.zeros(len(length_df_over)*19*2).reshape(-1,2))\n","new_dir_df.columns = dir_df.columns\n","\n","for index in tqdm(range(len(length_df_over))):\n","  new_dir_df.iloc[index*19:(index+1)*19,:]  = dir_df.loc[init.droped_indexes(dir_df,length_df_over,index,standard=19)]\n","new_dir_df = new_dir_df.sort_values(by=['key','dir'])\n","new_dir_df = new_dir_df.reset_index().drop(columns = 'index')"]},{"cell_type":"markdown","metadata":{"id":"fggGNd-N0YfV"},"source":["## csvs 생성 - z 스코어 임베딩 + 중복제거 \n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":388,"status":"ok","timestamp":1645238915845,"user":{"displayName":"­임훈","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"15355961264808837253"},"user_tz":-540},"id":"aqe-IPZm0hvy","colab":{"base_uri":"https://localhost:8080/"},"outputId":"78c051f3-8d96-48e4-96f5-496d68dc857c"},"outputs":[{"output_type":"stream","name":"stdout","text":["1606 1606\n"]}],"source":["#19장의 사진으로 추린 new_dir_df로 새로운 키 리스트만듬) \n","\n","key_lists = np.unique(new_dir_df['key'])\n","key_lists.sort()\n","\n","Embedding_columns = snsb_df.columns[5:]\n","\n","for column in Embedding_columns:\n","  snsb_df[f'E_{column}'] = snsb_df[column].map(init.zscore_Embedding)\n","\n","#정렬 \n","snsb_df = snsb_df.sort_values(by=['병록번호'])\n","new_dir_df = new_dir_df.sort_values(by=['key','dir'])\n","\n","#snsb_df 중 key_lists에 있는 행들만 추림 -> csvs \n","csvs = snsb_df[snsb_df['병록번호'].apply(lambda x : x in key_lists)].sort_values(by=['병록번호'])\n","csvs = csvs.reset_index().drop(columns = 'index')\n","\n","#중복 제거 : 이름으로 정렬 후 중복 제거 \n","csvs = csvs.sort_values(by=['성명'])\n","csvs = csvs.drop_duplicates(['병록번호'], keep = 'first')\n","\n","#다시 병록번호 로 정렬 해서 csvs 와 new_dir_df 순을 맞춤 \n","csvs = csvs.sort_values(['병록번호'])\n","csvs = csvs.reset_index().drop(columns = 'index')\n","new_dir_df = new_dir_df.sort_values(by=['key','dir'])\n","new_dir_df = new_dir_df.reset_index().drop(columns = 'index')\n","\n","#맞춤 확인 \n","print(len(csvs),len(np.unique(new_dir_df['key'])))"]},{"cell_type":"markdown","metadata":{"id":"W7ML5r7Z4i0U"},"source":["# 전처리"]},{"cell_type":"markdown","source":["## new_dir_df 증강 "],"metadata":{"id":"EX-1jaFPVI4F"}},{"cell_type":"code","source":["new_dir_df['dir_1'] = 0\n","new_dir_df['dir_2'] = 0 \n","new_dir_df['dir_1'].iloc[:-1] = new_dir_df['dir'].iloc[1:]\n","new_dir_df['dir_2'].iloc[:-2] = new_dir_df['dir'].iloc[2:]"],"metadata":{"id":"lNtzO8yETCF0"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["i = 0 \n","drop_indexes = [] \n","for i in range(len(key_lists)):\n","  drop_index = new_dir_df[new_dir_df['key']==key_lists[i]].iloc[17:20,].index\n","  drop_indexes.append(drop_index)\n","drop_indexes = np.array(drop_indexes).reshape(-1,)\n","new_dir_df.drop(drop_indexes,inplace=True)\n","new_dir_df = new_dir_df.reset_index().drop(columns = 'index')"],"metadata":{"id":"k6xdTC1cQNcy"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## csvs 증강 "],"metadata":{"id":"2I0_BW-5YyZh"}},{"cell_type":"code","source":["temp_csvs = np.array(csvs)\n","for i in tqdm(range(16)):\n","  temp_csvs = np.vstack([temp_csvs,np.array(csvs)])\n","temp_csvs = pd.DataFrame(temp_csvs)\n","temp_csvs.columns = csvs.columns\n","csvs = temp_csvs.sort_values(by=['병록번호']).reset_index().drop(columns = 'index')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"86aUi3ehlbSj","executionInfo":{"status":"ok","timestamp":1645196993240,"user_tz":-540,"elapsed":515,"user":{"displayName":"­임훈","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"15355961264808837253"}},"outputId":"4cc1facf-9a11-4c22-b0ee-38922f182edc"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 16/16 [00:00<00:00, 247.25it/s]\n"]}]},{"cell_type":"markdown","source":["## Augmentation "],"metadata":{"id":"FpQ6WGP4LF-I"}},{"cell_type":"code","source":["#이미지 콘트라스트 변경 \n","def img_Contrast(img): \n","  import cv2 \n","  lab = cv2.cvtColor(img, cv2.COLOR_BGR2LAB)\n","  l, a, b = cv2.split(lab)\n","  clahe = cv2.createCLAHE(clipLimit=3.0, tileGridSize=(8, 8)) \n","  cl = clahe.apply(l)\n","  limg = cv2.merge((cl, a, b))\n","  final = cv2.cvtColor(limg, cv2.COLOR_LAB2BGR)\n","  return final \n","#가우시안 블러 \n","def gaussianblur(image):\n","  import cv2 \n","  import numpy as np \n","  blur = cv2.GaussianBlur(image, (5,5), np.random.randint(0,3,1))\n","  return blur\n","\n","#랜덤 어그먼테이션 \n","def random_aug(aug_image):\n","  import numpy as np \n","  import cv2 \n","  n = np.random.randint(0,4,1)\n","  if n == 0:\n","    aug_image = cv2.flip(aug_image,np.random.randint(0,2,1))\n","  if n == 1:\n","    aug_image = img_Contrast(aug_image)\n","  if n ==2:\n","    aug_image = gaussianblur(aug_image)\n","  return aug_image\n","  if n ==3:\n","    return aug_image "],"metadata":{"id":"pbX4pUJcLJDY"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"zKC5TzWeXBKH"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"ZaVmNxsN-JvR"},"source":["## 이미지 전처리"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"d-z0VSeyBA6b"},"outputs":[],"source":["def plot_img(temp_img):\n","  plt.figure(figsize=(10,10))\n","  plt.imshow(temp_img)\n","  plt.show()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"thvDsi6n-GgV"},"outputs":[],"source":["#이미지 전처리 \n","def img_preprocess(img):\n","  shape = img.shape[0]\n","  preprocessed_img = img[int(shape*0.05):int(shape*0.95),int(shape*0.1):int(shape*0.9),:] #crop \n","  preprocessed_img = cv2.cvtColor(preprocessed_img, cv2.COLOR_BGR2GRAY)\n","  preprocessed_img = cv2.resize(preprocessed_img,dsize=(224,224)) #resize Albu mentations -> vision 관련 augmentation document \n","  #scaling -> /255. \n","  preprocessed_img = efficientnet.preprocess_input(preprocessed_img) \n","  return preprocessed_img \n","\n","\n","#더미 넘파이 만든 후 거기다 224,224 grayscale 이미지 넣음\n","#디렉토리 df로 이미지 만듬 \n","def read_imgs(indexed_df):\n","    temp_img_1 = img_preprocess(cv2.imread(indexed_df['dir']))\n","    temp_img_2 = img_preprocess(cv2.imread(indexed_df['dir_1']))\n","    temp_img_3 = img_preprocess(cv2.imread(indexed_df['dir_2']))\n","    temp_imgs = np.stack([temp_img_1,temp_img_2,temp_img_3],axis=2)\n","    temp_imgs = random_aug(temp_imgs) #어그먼테이션 \n","    return temp_imgs\n","\n"]},{"cell_type":"code","source":["new_dir_df['dir'][4]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"mYJzJmEKfqfl","executionInfo":{"status":"ok","timestamp":1645198890320,"user_tz":-540,"elapsed":366,"user":{"displayName":"­임훈","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"15355961264808837253"}},"outputId":"4e780455-4038-4500-8fee-d36d073ec76e"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'/content/KYR_B_imaging/swr8/0000047370005.jpg'"]},"metadata":{},"execution_count":133}]},{"cell_type":"markdown","metadata":{"id":"x4DZ7OS8nkyd"},"source":["# 데이터 제너레이터"]},{"cell_type":"markdown","metadata":{"id":"2fOR-6Hj5Cqd"},"source":["## 사전설정"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WfdUHzsn8qQp"},"outputs":[],"source":["input_columns = ['만나이','교육년수']\n","output_columns = ['E_SVLT_recall_total_score_z', 'E_SVLT_Delayed_recall_z',\n","       'E_SVLT_recognition_score_z', 'E_RCFT_immediate_recall_z',\n","       'E_RCFT_delayed_recall_z', 'E_RCFT_recognition_score_z',\n","       'E_K_MMSE_total_score_z', 'E_SNSB_II_Domain_Attention_z',\n","       'E_SNSB_II_Domain_Language_z', 'E_SNSB_II_Domain_Visuospatial_z',\n","       'E_SNSB_II_Domain_Memory_z', 'E_SNSB_II_Domain_Frontal_z']\n","\n","csvs_max = np.array([90,18])\n","csvs_min = np.array([45,0])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"H2W_q0UKNRwm"},"outputs":[],"source":["from tensorflow.keras.preprocessing import image\n","from tensorflow.keras.utils import Sequence\n","import math\n","\n","\n","class DataGenerator(Sequence):\n","  def __init__(self,\n","                 new_dir_df,\n","                 csvs,\n","                 batch_size: int,\n","                 augmentation: bool = False,\n","                 shuffle: bool = False,\n","                 rescale:bool = True) -> None:\n","        self.input_columns = input_columns \n","        self.output_columns = output_columns\n","        self.batch_size = batch_size\n","        self.shuffle = shuffle\n","        self.augmentation = augmentation\n","        self.rescale =rescale\n","        self.new_dir_df = new_dir_df\n","        self.csvs = csvs\n","\n","  def __len__(self):\n","    return math.ceil(len(self.new_dir_df) / self.batch_size)\n","    \n","  # def _shuffle_index(self):\n","  #   if self.shuffle == True:\n","  #       np.random.shuffle(self.indexes)\n","\n","\n","  def __getitem__(self, index):\n","    # csvs_input = self.csvs[self.input_columns].iloc[index*self.batch_size:(index+1):self.batch_size,:]\n","    csvs_output = self.csvs[self.output_columns].iloc[index*self.batch_size : (index+1)*self.batch_size,:]\n","    imgs_dir_df = self.new_dir_df[index*self.batch_size : (index+1)*self.batch_size]\n","\n","    imgs = []\n","    for i in range(len(imgs_dir_df)):\n","      indexed_df = imgs_dir_df.iloc[i,:]\n","      temp_imgs = read_imgs(indexed_df)\n","      imgs.append(temp_imgs)\n","    imgs = np.array(imgs)\n","\n","    # csvs_input = np.array(csvs_input)\n","    # csvs_input = (csvs_input - csvs_min)/(csvs_max - csvs_min)\n","    csvs_output = np.array(csvs_output).astype(np.float)\n","    imgs=  np.array(imgs).astype(np.float)\n","    \n","    # return [imgs, csvs_input], csvs_output\n","    return imgs, [np.array(csvs_output[:,0]),np.array(csvs_output[:,1]),np.array(csvs_output[:,2]),np.array(csvs_output[:,3]),\n","                  np.array(csvs_output[:,4]),np.array(csvs_output[:,5]),np.array(csvs_output[:,6]),np.array(csvs_output[:,7]),\n","                  np.array(csvs_output[:,8]),np.array(csvs_output[:,9]),np.array(csvs_output[:,10]),np.array(csvs_output[:,11])]\n","train = 964*17\n","valid = 1285*17\n","# train = 900*17\n","# valid = 1200*17\n","train_generator = DataGenerator(new_dir_df[:train],csvs[:train],batch_size=64,shuffle=True)\n","valid_generator = DataGenerator(new_dir_df[train:valid],csvs[train:valid],batch_size=64,shuffle=False)\n","test_generator = DataGenerator(new_dir_df[valid:],csvs[valid:],batch_size=64)"]},{"cell_type":"markdown","source":["1. 모델 구조 \n","2. 스케일링 \n","3. 아웃풋 \n","4. 어그먼테이션 \n","5. "],"metadata":{"id":"SwYYl4mdFEO4"}},{"cell_type":"markdown","source":["train : 964*17\n","\n","valid : [964~1285]*17\n","\n","test : [1285~1606]*17 \n","\n","약 60:20:20"],"metadata":{"id":"5MlWvHz75Mma"}},{"cell_type":"markdown","metadata":{"id":"5zG5rfQ9OaJn"},"source":["#모델"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Zw4xryIZObDe"},"outputs":[],"source":["from tensorflow.keras import optimizers\n","import tensorflow as tfa \n","from tensorflow.keras import layers\n","from tensorflow.keras.layers import Bidirectional, LSTM, GRU\n","from tensorflow.keras.layers import BatchNormalization,Conv2D,MaxPooling2D,Activation,Dropout,Dense,Flatten,Input,Conv3D,MaxPooling3D\n","from tensorflow.keras.layers import Conv3D, ConvLSTM2D, BatchNormalization, Input, Dropout, Bidirectional\n","from tensorflow.keras import Model\n","from tensorflow.keras.layers import concatenate\n","from tensorflow.keras.applications import resnet50, efficientnet\n","from tensorflow.keras.applications import ResNet50, EfficientNetB0"]},{"cell_type":"code","source":["def output(x):\n","  output_2 = Dense(32,activation = 'relu')(x)\n","  output_2 = BatchNormalization()(output_2)\n","  output_2 = Dense(16,activation = 'relu')(output_2)\n","  output_2 = BatchNormalization()(output_2) \n","  output_2 = Dense(2, activation = 'softmax')(output_2)\n","  return output_2\n","\n","conv_layers = EfficientNetB0(weights='imagenet', include_top=False, input_shape=(224, 224,3)) #size -> 256, 256 \n","conv_layers.trainable = False"],"metadata":{"id":"vSNz8LLxSBPP"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"x7JIaUpJOedL"},"outputs":[],"source":["from tensorflow.python import keras\n","def make_model():\n","  image_input = Input((224,224,3))\n","\n","  x = conv_layers(image_input) \n","  #\n","  x = Flatten()(x) #con layer 끝난 뒤 아키텍처 확인 -> flatten 대신 pooling  가능? \n","  \n"," #output이 너무 많다 \n","  output_1 = output(x)\n","  output_2 = output(x)\n","  output_3 = output(x)\n","  output_4 = output(x)\n","  output_5 = output(x)\n","  output_6 = output(x)\n","  output_7 = output(x)\n","  output_8 = output(x)\n","  output_9 = output(x)\n","  output_10 = output(x)\n","  output_11 = output(x)\n","  output_12 = output(x)\n","\n","  model = Model(image_input,[output_1,output_2,output_3,output_4,output_5,output_6,output_7,output_8,output_9,output_10,output_11,output_12])\n","  model.compile(optimizer='adam',loss = 'sparse_categorical_crossentropy',metrics=['accuracy'])\n","  return model\n","model = make_model()"]},{"cell_type":"code","source":["2**12"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7mfT-O8TDoj8","executionInfo":{"status":"ok","timestamp":1645359306237,"user_tz":-540,"elapsed":8,"user":{"displayName":"­임훈","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"15355961264808837253"}},"outputId":"2caaf9f3-09e4-4ef0-b748-fc171946119d"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["4096"]},"metadata":{},"execution_count":1}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PsO6QNg-SzVE"},"outputs":[],"source":["from tensorflow.keras.utils import plot_model\n","plot_model(model)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":322},"id":"4vGjA_FdOk-N","executionInfo":{"status":"ok","timestamp":1645233817083,"user_tz":-540,"elapsed":27820383,"user":{"displayName":"­임훈","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"15355961264808837253"}},"outputId":"74504204-93a5-4445-c1c3-64c59b65b48e"},"outputs":[{"output_type":"display_data","data":{"image/png":"iVBORw0KGgoAAAANSUhEUgAAAWoAAAD4CAYAAADFAawfAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO2dd3hUVfrHP2cmvZNKIBB6D70jRUBU7IIiIIor4lqw99XVdXV33XXVtfzWtYANEAVUBAQVUASkJPTeCQFCEkogCSHt/P44M0wS0slkJsn7eR6eydx7595zmeQ773zP+75Haa0RBEEQ3BeLqwcgCIIglI0ItSAIgpsjQi0IguDmiFALgiC4OSLUgiAIbo6HM04aHh6umzVr5oxTC4Ig1EkSEhLStNYRJe1zilA3a9aM+Ph4Z5xaEAShTqKUOlTaPrE+BEEQ3BwRakEQBDenQkKtlHpUKbVNKbVVKTVTKeXj7IEJgiAIhnI9aqVUY+AhoIPW+pxS6ivgNuATJ49NEIRaRG5uLklJSWRnZ7t6KG6Nj48PMTExeHp6Vvg1FZ1M9AB8lVK5gB9wtArjEwShDpOUlERgYCDNmjVDKeXq4bglWmtOnDhBUlISzZs3r/DryrU+tNZHgNeBROAYkK61/rH4cUqpyUqpeKVUfGpqaiWGLghCXSA7O5uwsDAR6TJQShEWFlbpbx3lCrVSqgFwA9AcaAT4K6VuL36c1voDrXVPrXXPiIgSUwEFQajjiEiXT1X+jyoymTgcOKC1TtVa5wJzgf6VvlI5ZOfm8+Hy/azef6K6Ty0IglCrqYhQJwJ9lVJ+ynwUDAN2VPtAlOLD3/bzf7/sq+5TC4JQTwgICHD1EJxCRTzqNcBsYD2wxfaaD6p7IF4eFu7oF8vy3ansTTlb3acXBEGotVQoj1pr/aLWup3WupPWeoLW+rwzBjO2d1O8PCxMW3nQGacXBKGeoLXmySefpFOnTsTFxTFr1iwAjh07xqBBg+jatSudOnXit99+Iz8/n4kTJ1449s0333Tx6C/GKb0+qkpYgDc3dW3MnPVJPHllW0L8vFw9JEEQqsBfvt/G9qNnqvWcHRoF8eJ1HSt07Ny5c9m4cSObNm0iLS2NXr16MWjQIGbMmMGVV17Jn/70J/Lz88nKymLjxo0cOXKErVu3AnD69OlqHXd14HYl5Hdd1ozs3AJmrj3s6qEIglBLWbFiBWPHjsVqtRIVFcXgwYNZt24dvXr1Ytq0abz00kts2bKFwMBAWrRowf79+5kyZQqLFi0iKCjI1cO/CLeKqAHaNQyif8swPvv9IJMGNsfT6nafJYIglENFI9+aZtCgQSxfvpwFCxYwceJEHnvsMe644w42bdrE4sWLef/99/nqq6+YOnWqq4daBLdUwbsGNOdYejaLtia7eiiCINRCBg4cyKxZs8jPzyc1NZXly5fTu3dvDh06RFRUFPfccw+TJk1i/fr1pKWlUVBQwKhRo3jllVdYv369q4d/EW4XUQMMbRdJiwh//vHDTga1iSDYt+I18YIgCDfddBO///47Xbp0QSnFP//5Txo2bMinn37Kv/71Lzw9PQkICOCzzz7jyJEj3HXXXRQUFADw97//3cWjvxilta72k/bs2VNf6sIBm/YmcsvUTYzo1Jh3xnaTiidBcHN27NhB+/btXT2MWkFJ/1dKqQStdc+SjnefiDo/F3bMg0Or4OBKuqTu4OvmY7lh83UMbhPBLT2buHqEgiAILsF9PGplge8fhU1fQlAjCGtN5/MJ9G0RyovztrE/NcPVIxQEQXAJ7iPUFitMXgZPH4IJc6HLbai03bx1vSmCuX/6es5m57p6lIIgCDWO+wg1QFhLsNrcmKZ9AWiYvoV3x3ZnT0oGD83cQF5+gQsHKAiCUPO4l1AXplF3sHjA4dVc1jqcl2/oyLJdqbyyoNr7QQmCILg17jOZWBwvP4juAofXAjC+Tyz7UzP5eMUBYsP8uGtAxVdHEARBqM24b0QN0KQPHEmAvBwAnhvZnis6RPGX77fz+e8HXTo0QRCEmsL9hTovG5I3A2C1KN4d143h7aN44bttfLzigIsHKAhCbaWs3tUHDx6kU6dONTiasnF/oQY4vObCJm8PK/83vjtXd2rIX+dv54PlstCAIAh1G/f1qAGCoiGkKSSuhn4PXNjs5WHhnbHdeGTWRv62cCf+3h6M7xPrwoEKglCEH56B5C3Ve86GcXD1P0rd/cwzz9CkSRMeeMBoxUsvvYSHhwfLli3j1KlT5Obm8sorr3DDDTdU6rLZ2dncd999xMfH4+HhwRtvvMHll1/Otm3buOuuu8jJyaGgoIA5c+bQqFEjbr31VpKSksjPz+eFF15gzJgxl3Tb4O5CDdCkLxz4FbSGQmXkHlYLb47pSlZOPs9/u5UQXy+u6RztwoEKguBKxowZwyOPPHJBqL/66isWL17MQw89RFBQEGlpafTt25frr7++Ui0p3nvvPZRSbNmyhZ07dzJixAh2797N+++/z8MPP8z48ePJyckhPz+fhQsX0qhRIxYsWABAenp6tdyb+wt10z6w5Ss4dRBCi2Z6eFotvDeuO3dMXcMjszYQ6OPBoDayAroguJwyIl9n0a1bN1JSUjh69Cipqak0aNCAhg0b8uijj7J8+XIsFgtHjhzh+PHjNGzYsMLnXbFiBVOmTAGgXbt2xMbGsnv3bvr168err75KUlISN998M61btyYuLo7HH3+cp59+mmuvvZaBAwdWy725t0cNhXzqtSXu9vWy8tGdvWgZEcA9n8WzdOfxGhycIAjuxC233MLs2bOZNWsWY8aMYfr06aSmppKQkMDGjRuJiooiOzu7Wq41btw45s2bh6+vLyNHjmTp0qW0adOG9evXExcXx/PPP8/LL79cLddyf6GO7ADeQbD9W8greanGYF9Ppk/qQ5uoQO75LIFvNiTV8CAFQXAHxowZw5dffsns2bO55ZZbSE9PJzIyEk9PT5YtW8ahQ4cqfc6BAwcyffp0AHbv3k1iYiJt27Zl//79tGjRgoceeogbbriBzZs3c/ToUfz8/Lj99tt58sknq623tfsLtcUKvSbBroXw/kBIXAO552DrHJgxxvw7tomwAG9mTu5Ln+ahPDprE1MldU8Q6h0dO3bk7NmzNG7cmOjoaMaPH098fDxxcXF89tlntGvXrtLnvP/++ykoKCAuLo4xY8bwySef4O3tzVdffUWnTp3o2rUrW7du5Y477mDLli307t2brl278pe//IXnn3++Wu7LbftRX8Sen2H+o5B+GLwCIOcsBDU2edZZJ6HreBj2Atk+ETzy5UYWbUvmkeGteXhYa+llLQg1gPSjrji1tx91ebQeDvf/Dr/9G7LSoNNoaDYQzp+B316H1e/D/mX4TEng3XHdeGbuFt76eQ9nzuXx/DXtsVhErAVBqJ3UHqEG8A6A4S8W3eYbAiNegZZD4fObYON0PHpN4p+jOhPo48HUlQc4m53La6M6i1gLglCELVu2MGHChCLbvL29WbNmTSmvcA21S6jLosXl0LgnrHwbuk/EYvXgz9d2INDHk7eX7CHQx5MXrm0vNoggOBGtda36G4uLi2Pjxo01es2q2M3uP5lYUZSCgY/B6UOw7RvbJsWjw1tz14BmTF15gI9+kwlGQXAWPj4+nDhxokpCVF/QWnPixAl8fHwq9bq6E1EDtLkaItrBijchbjQohVKKF67pQMqZ87y6cAeRQd7c0LWxq0cqCHWOmJgYkpKSSE1NdfVQ3BofHx9iYmIq9Zq6JdQWC1z2KHxzL+xeDG2vsm1W/PvWLqRlnOeJrzcRGehDv5ZhLh6sINQtPD09ad5c+sQ7g7pjfdjpNAqCm8KKN0x/EBs+nlY+uKMnsWH+3Pt5PHtTZLFcQRBqB3VPqK2e0H+KaY2auLrIrmBfT6ZN7IWXh4W7PlnLiYySKx0FQRDciXKFWinVVim1sdC/M0qpR2picFWm2+3gFwYr37poV5NQPz66sxcpZ84z6bN4snLyXDBAQRCEilOuUGutd2mtu2qtuwI9gCzgG6eP7FLw8oPe98LuRXB8+0W7uzYJ4T+3dWXT4dNMnLaOjPMi1oIguC+VtT6GAfu01pXvbFLT9L4HPP1g1Tsl7r6qUzRv3daNhEOnmPDxGtLP5dbwAAVBECpGZYX6NmCmMwZS7fiFQvc7TC/r9JK76V3fpRHvjevO1iPp3P7RGtKzRKwFQXA/KizUSikv4Hrg61L2T1ZKxSul4t0mj7Lv/Sbz4/f/K/WQqzo15H8TerAz+QwPzlxPXn5BDQ5QEAShfCoTUV8NrNdal9iZX2v9gda6p9a6Z0SEm6yy0iDWpOslfALJW0s9bGgzX2Z12cTaPUd5deGOmhufIAhCBaiMUI+lttgehRn2AvgEw2c3QOqui/fnnoOZt9F9+z/4V9tdTFt5kFnrEmt+nIIgCKVQIaFWSvkDVwBznTscJxDSFO783ixA8On1cGKfY19+Lnw9EQ6tAg9frg3az8DW4Tz/7VaW73YT+0YQhHpPhYRaa52ptQ7TWlfPkro1TXgruGMeFOTBxyNg7r2my96cSSaF75rXoc0ILImreHdcd1pGBDDp03h+3i7rLwqC4HrqXmViaUS2gzvnQeMecOBX+OkFsw7j0BfMUl+xl0H6YYKzj/Ll5L60jw7kj18k8OvypZBbPYthCoIgVIW61ZSpPKI6wvivzM+ZJyD7NIS1NM+bDTCPh1YS0nUcX0zqw3MffcvAJePYlvwoHW99seRzCoIgOJn6E1EXxz/MIdIAEe3BtwEcXAlAoI8nb7TZjkVpMrcuZPG2ZBcNVBCE+k79FeriWCwQOwAO/maeFxTgudVE3z0su3l2xkp+2yMTjIIg1Dwi1IWJHWBWiElPgoPL4UwS9LoHKwXcFLyHyZ8lkHDolKtHKQhCPUOEujB2n/rgStg4A7yDzWK63kE80SqJyCBv/vhFAilnZHJREISaQ4S6MFGdjDjv/gG2z4O4UeAdCM0H4XvoF/53e3cysvN4YMZ6cqXUXBCEGkKEujAWK8T2N4vj5p2DruPN9lbDIf0w7TyS+ceoONYdPMXfpNRcEIQaQoS6OHb7I7yNybkGaDXMPO5dwg1dG3PXgGZMW3mQr+IPu2aMgiDUK0Soi9NsoHnsMhaUMj+HNIXwtrD3ZwCeG9mey1qF89TszXyy8oCLBioIQn1BhLo4jbrC+NnQ74Gi21sNg0MrIfccnlYLH93ZkxEdonjp++288dNudKGFdAVBEKoTEeqSaH0FeHgX3dZqGORlw/zHYMYYfN7twvsNvmBs9yjeXrKHN3/a7ZqxCoJQ5xGhriixA8AnBDbNhFMHIbI9loRp/C37r4zrEsx7v+zjwLofYOpVsOg5V49WEIQ6RP3q9XEpePrCQxvA6gXeAWbbhumo7x/ir6HHGentS/MF69HKgjq2GYb9GTx9XDtmQRDqBBJRVwa/UIdIA3QbD7fPwXr2CL099vJq7jiWxP0LcjPh4IqaH9+Zo6bHtiAIdQoR6kulxRCYsh7Px7awt9VdPLExkgIPX1M0U5PkZsO7vWDdRzV7XUEQnI4IdXUQEIHyDeHlGzpxXnsRb+1Kwa4fzMK6NUX6YcjJgGObyz4ubQ+clqXGBKE2IUJdjTQJ9eO10Z2ZkxmH5cwRMhI31NzFTx8yjyf3l33cV3fCD087fzyCIFQbItTVzPVdGjHihjso0Ipvv/yYU5k5ZseRBNg403lRtj1KLkuo885D6k7THVAQhFqDCLUTGNYrjrPhnemc9Tuj3l/FwV2b4LOb4Ns/wvxHIT+v+i9qF+rMFMg+U/IxJ/aCzodM6astCLUJEWonEdzlOjqrfTTIOkj+jNs4r5VZmzFhGsy6HXIyq/eChX3nU6WUtafYGkllpECBdP8ThNqCCLWzaDsSgK+8X6GZSubOjAd5ueBuCq7+l1n5/IvR1WuDnE4Ev3Dzc2n2h12odT6ckwUQBKG2IELtLCI7QHBTrFmpcNU/aNd3JFNXHuDZw30puOo1SFwFh1ZV3/VOH4bmg8zPJ/aVfExKodasGcer79qCIDgVqUx0FkrB0D/B6USsfSbzIhDo48E7S/dize/Cq95BqPWfOtqqXgq52ZCRDJHtITEaTpZifaTuAP8I41FnpgAdLv3agiA4HYmonUmX22DwU6AUSikeH9GWR4a3ZsaGE6zyG4re9i1knSz/PFqbrJHSrBJ7FkdIUwhtASdLiKhzzxkBbz7YPM9Iqdo9CYJQ44hQ1zCPDG/DlKGteDW5Nyr/PGz+yrHz1CFY++HFE317l8CHQ2HXwpJPas+hDmkKoc1L9qhTdwEaWohQC0JtQ4TaBTwyvA2ejbuwjZbkxU8zkXJmGnx+Iyx8AhJ/L/oCezn6lq9LPqE94yOkKYS2NP7z+Yyix6TuNI9N+oDVWzxqQahFiFC7AKtF8drozszIuxyPtJ1wYDnMvM00VbJ6FY2ctYY9P5qfdy26WIDBCLXFAwKjjfUBF0fVKdvNuUNbQkCk5FILQi1ChNpFtGsYRMMB48nU3uRPHwNJ8XDzh8ZD3rnA4Uen7TZCHHerWXB396KLT3Y6EYJjzOK8pQr1TrMOpNXDCLVE1IJQaxChdiGTr+jCL16Dseaf4+TAl6DD9dBupClYsafS2aPpYS+YiHnr3ItPdDrR2B5QSKiLTSim7DBZIQD+kZAhEbUg1BZEqF2It4eV5uPe4H71HFes6siGxFMXCmXYtcA87vkRIjsaIe54E+z9Cc6dLnqiwkLtHQABUUUj6vNnIT0RItqZ5xJRC0KtokJCrZQKUUrNVkrtVErtUEr1c/bA6gsdmjfhifsfwN/bg7EfrmZxItC4J+xcaHp2HPodWg83B3caBfk5xhqxY8+hDol1bAttWTSXOnWXeYy05U0HREJWGhTkO45Z/zn8+LxT7lEQhEujohH1f4BFWut2QBdgRznHC5WgRUQAc+/vT7uGQdz7eQJL6QlH18OmL6EgF1qPMAc27mEi522F7I8zR8xjcBPHttAWRasT7TZKpC2i9o8EXQBZJxzHbJwBv79XsbxuQRBqlHKFWikVDAwCPgbQWudorU+X/SqhsoQHeDPznr7c0S+WV/e3BCB/yV/BO8ik1IGpdux4M+xbBpk2kS2cQ20ntLmJsu2Nn1J2gIcvhDQzzwMizWPhXOrUnUa8dy92zg0KglBlKhJRNwdSgWlKqQ1KqY+UUv7FD1JKTVZKxSul4lNTZaKqKvh6WXn5hk68OPFGEonGmnOGE1EDwOrpOCjuFtNUKWGqeV44h9pOmBH6Cz516g6IaAsW29t9QahtPnVmGpyzRdKlFdUIguAyKiLUHkB34L9a625AJvBM8YO01h9orXtqrXtGRERU8zDrF4PaRhLZ62YA3k1qQcrZbMfOhp2gzdWw8m1jUxTOobZjz/zYtwxm3w37lkJMT8f+gCjzaM+ltnvYDZqbKsjcQtcTBMHlVESok4AkrfUa2/PZGOEWnIhPn7vIbDyQH3K78tDMDeTlFyorH/Znk8mx4g0j1EGNTX60HbtQ//SCmXgc+AQMf8mx39/2QWq3PuxVi/2nuG4FdUEQSqVcodZaJwOHlVJtbZuGAdudOioBwlvjf898nrixP6v3n+TNn3c79kV1MA2f1nxgCmUK2x4A3oHGIukxER7aYHKwvQOL7vfwdVgfabvB0x+6jgNPP7E/BMHNqGjWxxRgulJqM9AV+JvzhiQUZnSPGMb0bMJ7y/axbFehyb8hzwLaFMcUTs2zM+ojuO4/EBR98T6lICCikPWxEyLagKcvtBwKNb2CuiAIZVIhodZab7T5z5211jdqrWV5kBrkLzd0pH10EI/O2siR0+fMxgax0PNu83PxiLoiBEQ5IurU3RBu+8LU7ho4exSObbr0gQuCUC1IZWItwMfTyv+N705evuaB6evJybP51YOegOiu0Oyyyp/UXkaefcYIc4RNqFuPAGUxUbUgCG6BCHUtoXm4P6+N6szGw6f5xw+2yT//cLj316qtEmMvI0+zed92ofYPN3nbuxaU/tqqkJ8L8x6SSF0QqoAIdS3ims7RTOzfjKkrD/D3hTvIzs0v/0WlERBpKhOPbzPP7X1AAFoNg+Qt1VuluG8ZrP8Utn9XfecUhHqCCHUt47mR7bmtVxP+t3w/V//nN1bvP1H+i0rCPwLQZoFdq1fRCclYW4SeuPqSx3uBzV+ax9JWSBcEoVREqGsZXh4W/jGqM9Mn9SG/QHPbB6v56LcqiJ+96OXgbxDWqmgedqPuRrwTq2mV9OwzjkZSpS28KwhCqYhQ11IGtApn8SODGBnXkFcW7ODz1YcqdwJ7GfmZIw5/2o6nj2kAdaiahHrHPMjLhuguRqgl9U+oCif2Fe0cWY8Qoa7F+HpZeWtMN4a3j+SFb7cyOyGp4i+2CzU4UvMKE9vfTPzZGztdCptnmWrJuFvhfDqck+xOoQqseR/mTHL1KFyCCHUtx8vDwrvjujOwdThPzd7E95uOVuyF/oWEunhEDdC0PxTkQdK6Sxtg+hE48Bt0HlP6MmGCUBGyTkJuFuSec/VIahwR6jqAj6eV/03oQc/YUB6ZtZFFW5PLf5F3gCkbh5KFuklvk099qfbHlq8AbUraLwi1+NRCFci2dVeuhz3TRajrCH5eHky9qxddYoKZMnM9S3ZUYKmtgAgjxmGtLt7nEwQN4y5NqLWGTbMgprdpvdrAllkiEbVQFexL0NVD60yEug4R4O3BJ3/oTfvoIO77Yn3R3iAlviDKtDb18C55f9P+pulTXk7VBnRyv+mFHXeLee7pazr9nZKIWqgC2enm8ZxE1EItJ8jHk8//0IfWUQHc+1kCP20vI7Ie8DAM/VPp+2P7Qd65qlcTHt9qHpv0cmxr0FysD6FquIv1kZQAhy9x7qaSiFDXQYL9PJkxqS/tGwVx3xcJLNxyrOQD211jFswtjab9zeOhlVUbyPFtxlopXPUY2rxs6yNtL5wpZbxC/UVr97E+fnweFj5eo5cUoa6jBPt58sXdvenaJIQHZ6zn01UHKSioZP5yQASEtYbE36s2iOPbjP/t6evYFtocMlPgfEbJr5lxK3w0DM5UMHtFcC0ZNbTsXm6WWegZXG99ZBw3Od01WA8gQl2HCfTx5NM/9GZQmwhenLeN0e+vYmfymcqdJLYfHPrdrChTWY5vg8gORbfZMz9K8qmzTsLJfaYIZ/otpqJRcF+Ob4fXW8ORBOdfy+5Pg+utj8w0yMlwtAmuAUSo6zj+3h5Mm9iLf9/ShQNpmVz79gpe/n47aRnnK3aC7nfC+TPw80uVu/D5DCPGUZ2Kbm/Q3DyW5FMnbzaP/aeYxQy+usN03RPck7RdgIaUnc6/lt32KP5zTZOXY4q2AE7srbHLilDXA5RSjOoRw5LHhzCqewyfrDrAwNeW8fcfdnAqs5yMjpie0Pd+WPdR5dZSTNlhHqM6Ft0eahfqEnzqoxvN42WPwXVvw/5l8OMLFb+mULOctUWUZ2vApsouLNQujKiz0hw/i1ALziDU34vXRnfmp8cGc2XHKD5Yvp9R76/iXE457VKHPm8i4e8ehJysi/cXFMDBlUU9O3vGR3Gh9gkGv7CSrY9jmyC4KfiFQrfx0GUcbPi87lSiaQ15FfwmUxvIsBVW1cTkr9368A5yrfWRWVio99XYZUWo6yEtIwJ467ZufHpXb/anZvLaonK+unr5wfXvGHFd9urF+xOmwicjYe/Pjm3Ht4FXYMnLhIW2KDmiPrYRojs7nncZY7zAPT9W7MbcnZX/gTc71h0756xNqM/WgFDb7Y4GzVyb9ZFZaPJUhFqoCQa1ieCuAc34ZNVBfttTzux984HQ8w/w+3sOiwKM6Kx4y/y8da5je8p2s1q6Uhefq0FzOHmw6LbsdCPejbo6tjUbaHqSbJ1TqftyS/JyYPX/mT/0UwddPZrqwS7UNZGhY7c+Qpu72Pqw9X+PaCfWh1BzPH1VO1pG+PPk15tJzyon0hv2orEtfnjKYXNsngXphyG0pVm+Ky/H7Du+9WLbw05oCziTVNQGOGabSIwuJNQWK3S8EXb/WLWsk/LITIN3epgCBmezY16hxYR3Of96NYH9flwRUbuqVa49om7a13zDLLiEVZYqgQh1PcfH08qbY7qSmnGeZ+ZuJi+/oPSDfUNg+ItweA1s+dr8kv72b9Nn+sq/maj4wK8mvS47vQyhbg66AE4nOrbZqx+juxQ9tuPNpjpy16JLu9GSOLzWREWbZlb/uYuz9kMIijE/p9URobZH1BkpzrdzstONP+0fYbo6nndR6mZmKlg8oVE3yM8xQUoNIEIt0DkmhGevbscPW5O557N4snLySj+46+3ml/THF2D9Z8auGPQktLzc/CFt+9axDmNkGRE1FE3RO7YRAhsV7ZMNZqHdoMbOsT9StpvH3YudG6Ed2wyHV0Pf+8w9pu1x3rVqirzzxoIIagxo5+cUZ58GnxDwbWCeu8qnzkwzC0CHtTbPa8j+EKEWAJg0sAV/uymOX3enMvaD1ZwoLc/aYoGRr5sZ/wWPQUR7aHuNaezU9mrYOd8RHUd1KPkcF3KpC03GHNtU1J8ufL2ON5mJyur+47QLdXqiI53QGaz7EDx8TSZLRJu6YX3YhblRN/Po7MyPc6dNxpBvqHnuqsyPzDTwC3d0nKyhCUURauEC4/o05X8TerLr+Fmue2cFX8UfLtkKiekJXccb+2LQE0ZMATrcaCKfdR+bNDuf4JIv5B9uvMb4aSYyO3/WRJnRJQg1QKebTflwdS/DdHy745q7nWCtgPlw2fw1dL7VRIPhbc291vblyM4WE2pn51JnnzbWm59NqF01oZhli6gDIk1Wkwi14Aqu6BDFrMn9CA/05qnZmxnx1nK+33SU/OJ9Qq76B4z62ES7dloONb+8Gcml+9NgMkFGvm682hVvQvJWQF/sT9tp1N0I+8YZ1SdweTlwYo8Zc3RXY384gw3Tjcfe+x7zPLw15Jyt/b1M7BOINRVRZ6fbImq79eGi6sTMVCPUSkFYC7E+BNfRpUkI3z0wgPdv74GHRTFl5gaGvL6MT1YeIPO8zb/2CYK40SYzw46nj7E/oHTbw07rK0yf6uWvm9CnVsAAACAASURBVMwRKNn6APNH0fcB08Vv05eVv6G8HNj1Q1GRP7HHTEpFdoA2V0HSWsg8Uflzl0VBAcR/DE36mkUYwLGaTm2fULRbH1EdzYr1zo6oz9k9aldbHyfMhCYY+0OEWnAlSimu6tSQHx4exPu39yAy0IeXvt/O4H8tY8exMmbc7RG2XZjK4sq/myXBEqaZRQwCG5Z+bK9Jpu3qoqcrH7399m+YeRsc/M2x7bjNn47qAG2uNDZO4YKd6uDAr2aytdfdjm32hYRr+4Ti2WTTwtY/AgKjayCitlkfFyLqKgh1bvaljSE323wb8gszz8NamayPGqg2FaEWysRqMYI9577+zLmvHx4WCxM+XsPelFLalLa5Cm79HNpdW/7JAyKMWEPp/rQdiwVueNdEx98/XLIFsucn+OyGotFWRir8/q75ubAQp2wHi4eZvY/uagprqtunjv/YRIDtr3dsC4g0X+FdNaGYmWY884NV7DFuJyPZ/J9ZrBDUyLlWTl6OaXPqEwJWD5NdVNmJ5ZMH4B9NTEpmVbH3+bBH1KEtzQd8DRQwiVALFaZHbCjT7+kDwO0freHwyRL6flgs0OF6sHpW7KRdboP+DxWNOksjrCUM+zPsWXyxBVKQD4uehf2/wLwpDiFf/i/TKySsFexd6jg+ZbsRaQ8vM+Y2I2DvkurLBz5zDHYuhG63G0vIjlK2CcXd1XOdirLrB/jgcvhXK5g7CeZOvrTznU12fAMKjHau9WHv8+EbYntsUHnr4+gGk/dsTx2tCvZiF/9w83gh88P59ocItVApWkYE8MWkPmTn5TP2w9UcP3OJXyeVghF/NfZDRehzr/F8Fz3tyDwA2PG9bXJwmEkRjJ9qoqj4qdB9gslSOb7FUaRhL3G30+Yq076yqoskFGf9Z6DzocfEi/eF13CKntaw4HFT/nz5n4yNdCapaIOhynL2uEOogxqZDyZnZbLYy8ftWUR+oZW3Puxiein53vY5jAsedYui53YiFRJqpdRBpdQWpdRGpVS8swcluDftGgbx+R/6cCozhzunriX9XA02GbJYTYOo3HPww5Nmm9bGhw5rDeO+MmK9+DkTWVs8YPAz0GqYOXbfUpMOeDqx6KIGLYaYY/ctLX7FypOfB+s/NRklYS0v3h/RxqxyU1NFG6m7TLXoZY/C4Cehww1m+7GNZb+uLDKSzbwCmIg671zRVqTViT3Dw6dQRF3Z/zv7nID9g7oq2CNqu0ft28D8XAMpepWJqC/XWnfVWvd02miEWkNcTDD/m9CTfakZ3PNZPNm5NdPzADBCN/gp2P4d7JhvvOfkzUaIrB5w0/vgHWgmD/v+EYKiISrOREJ7lziKWwoLtXcgxPQ21klxlv0N5j8GCZ+Y1UwyUs3EUmkR5J7FRhh7/qHk/TU9obhviXm0f1g1tHUorOqixfm5RrQCo83zINujsyYUL7I+QitvfZyw/V9fSkRd3KMGW+aHewm1IBThstbhvH5LF9YeOMkjX24kJ6+MPiHVzYBHzOoxC58wQhrcxBSVgJmwGz3NVEwOeNhss1hMhLt/WaFe2cVSCFsMMZ0BC4vAqYPw62smQv7+YfhwKLzeCl6Ngr9GwKLnLh7b+s+NiLW5uuSxR7Qxj3b7Y/8v8OEw50XYe5eYbxv2lrO+IaY69GgVI+qMFPMYaI+oG5lHZ/nUl2p9aF19EbXVy3yo2wmJNZWtTqaiQq2BH5VSCUqpEmchlFKTlVLxSqn41NQaWvBScDk3dG3M89e0Z9G2ZK55+zcSDtVQfqvV01ggGcfh6HozIVl4ArP5QBg7w5HOBcYSyTphJiK9Akz1ZGFaDAF00TQ+ezXkA2vhoY0mo2Xk66aTYEwvk1qYk+k4/txpE8F2GmWi+5IIiQWrt8mlTj8Cs/8AR+Irt4JORck9Z/LP7dG0nUZdqx5R2xcMCLB71E6OqO0fYIWtj+x0YzFVhLPJpq+5sjg+ZKqCPYe6cOvegEjzDcvJlaYVFerLtNbdgauBB5RSg4ofoLX+QGvdU2vdMyIi4uIzCHWWSQNbMHViT7Jy8hn13995/tstnMmuAd+6cXcY8qyxMLpPKP/4lkPN4+E1pp+wpdivf+PuprKysP2xY76J3MNamq5/Ha43VYYDHzMr3+RmmYwKO7sWmuyCwhWbxbFYzVfm49thzt3GRrF6mXFVN4dWQV42tBpedHt0Fzh9qGwLoTQhtE/iFs76AOe1Oy3J+ii8vTzstkfDzuaDvaqimpnq8KftBEQaf94ZbXgLUSGh1lofsT2mAN8AvZ05KKH2MbRdFD8+Oog/DGjOjDWJjHhjOT9tr4FVmgc/BfetAk/f8o8NiHCUqZdUOWn1hGaXOYQ6I8VkgZSWE960n+ket2W2Y9u2b0yk3rhH2WOJaGMi78Tf4fq3TS734XXl30NZaG26GhYez76lJnqPHVD0WHveun1B4eKs+8jkHa/98GJhswuyXag9vI2AOSuXOvu0aWrl4W2eV7bfh932aHaZ6RlT1arGzNSi/jSYXHL7PidSrlArpfyVUoH2n4ERwFanjkqolfh7e/Dn6zow9/4BhPh5cs9n8TwwfT3J6ZeYwlceJa0iUxotbRZAaS1YWwwx1YSnDpnoGA3tSxFqi8U0jNr7k/njzzpphLHjjeWPyT6h2OMuU4rfpLfJ9S1c5ZaTCT+9aMZSEfYvg1Vvw7f3OWyNvUsgtp9ZTq0w9g+sknzq/Fz47Q0j0AufgM9vKirCGccB5RApMD61syJqe+c8O3Y7q6KCe2IvePqZb0zgsG4qi70hU2HsbXkvxVKpABWJqKOAFUqpTcBaYIHW2kmtxoS6QNcmIcx78DKeGNGGn7Yf5/LXf+HNn3aX3ee6pmh3rfEqm/QqeX+LIebxwK/G9mjQzFgfpRF3i+kZsv0742cX5BnxLo+4W6Dfg6a5FRihzj/vWOkGTHS+8i2YObaoD14SWsPSV0yE7xdmfO/U3ZC6w/HhVBi/UDO5WJJPve0bk7Vy66dwzRvGkvnvgEKrjicbwSrswQdFOzeittse4LA+Kjr5mrbHWFd2i6aqmR+ZaRdH1BeE2rnfHssVaq31fq11F9u/jlrrElY3FYSieHlYeHBoa35+bDBD20fynyV7GPKvX1i19xKKLKqDmB7w1P7SrYmItmaSbPs8I9btri07Om7Y2WRUbJ0D2+YaYS+vHB4gvBVc+aqjajHG5iYmFSpx3v6drdx8B3x7f9ne6u5FJnVw8NNw8wcmZeyLUWZf8YlEO9FdLs6l1tpE5eFtodUVpmL07h+NKK770BxTuCrRTmC0cz1qn0JC7VfJfh9pu817ZM/7PlsFUc3JNPMRxT1qd7E+BOFSaBrmx3vjujPnvv6E+Hly1yfr+HW3i7OCCmeCFEcpE1Xv/clMCra/ruxzKWWi44MrYP+vZumwylgxdoKiTYRrn1DMTod9y6DbBBj+Emz/1rSELYmCAlj6qlk5p+s4aD7I9AlPTzQCGllKJ8PoLsbmKTwpd2A5JG+B/g86JlsbxkHbkabPeO45W7FLMaEOamTEKi+n4vf8zX2w5n/lH3cp1kdutiluCi8k1FWxPjJLyKEGW8tTi+sjakGoDnrENuDLyf1oGRHAPZ/Gs2yncz29S6LFEPMYEOWIdMsibjSgTcl4Wdke5RHT2zQN0tr0xy7INVWE/R8y6X5LXjY9OrbOLSquO74z5fFDnnWkKA5+BlpfCd3vKP2DI9rWS7qw3bLqHSNGcbcWPbbfAyaC3fSlrXw8quj+C7ZCBUUwbQ9smlGxtrXFrQ/vYCOOFbE+Tu4HtImovQNMWmZVIuoLxS7FPGqL1UTZTvaoS0n0FITqJ9Tfixn39GHCx2uZ/Hk8d1/WgmHtI+nWJAQPqxvFDC0Gm8e2Iy9O4SuJsJbGSjl/tmLtXUujSR/YOhvSk4ztERgNjXsaob3+XfDyNz1NNs8CZTU+s4evEayIdkbM7Vg9YPxXZV/PPqF4bJPJOz++3XyTuPz5oo2kAGL7G0vn9/dM+btdmO0E2YpezhxzFNaUhb0H+fGtJgr38Cr92HPFrA+LxVZGXkpEnZNp/q/AkZoXblvjMCCqeiNqMPaHk60PEWqhRgnx8+KLSX14bNZGPvxtP+//uo8gHw9u692Uh4e1xt/bDX4lgxrBmOmmoKWijPnCZEtUxfaw08QWve9basriu9/p+KDw8jMFPte8CUnrTGpfZprJkc47D70nF13EoSIERJjJx31LTF/l9Z+biLOkToZKmcnPuZNsry0WUduF+nQiNO1T9nULCoxQe/oZ3/f4VkdGRknHnj9TNKKG0svI9/wEX46DiQvNhLE9Nc/e6S6wYdWiX7tQF/eowVb04lzrww3+KoT6RrCvJx9P7EX6uVxW7k1j0dZkPli+n+83HeXF6zpyZcco1KUIXnVQWkpeadiF6lKI6mTEa/nrRoA7XH/xMVYPk24X2+/Srwcmqt610HjTcbeY0nx7nnJxOt4IP/3ZlIoXn0wMbwOe/mYytPMtZV/z8Goj6Jc/D8teMZWlpQn1+XRAX7z+ZmmNmXZ8b+YWFjwGk38xQh3YyNgeYD5gKlqRmbLTiLBfaKEWpyVE1AGRTu/34UbfN4X6RrCvJyPjonl7bDfm3NePYF9P/vhFAi/P3+7qobkGq4exUNITjSA0rSYxLouBj5vWpw9vNs2sItuVMT5P02YWTCRefF+T3qYSsjw2fWk+kPreZyLUoxtKP7Z45zw7JfX70NrkkgdEmUKedR8b6yO8leOYgKiyo1+tTVT+ybXwf31g6pW2HPk08PBxWCqF8Y8wdpATy8hFqAW3oEdsKPOnXMb4Pk2ZtvIgq/a5OI3PVdjtj3bXVt7KqAoxPU11Z3Dj8o8F6Hs/3PqZY1HbwsQOMI35y8rGyM2Gbd+abBrvAHOeI2UIdfHycTu+oZBVLKI+ud9E6oOeNBPCS18xja/CWjuOCYwyfT/Ol7BCUUGBEejpo02EPOBhU2w0/RbzWLzPh52AKPMN6HwZS9RdIiLUgtvgYbXw/DUdiA3z49m5WziXU4OtU92FZgPNY+GJQXfCw8tkopQkWLH9AV12z5Ldi4yd0XmMed6ou8kTL62gJ7uUiLqkyUR76X+Ly2Hkv00PjpwMx0QiONIKS4qq9y+DQyts3zA2wRUvwy3TjDWzY97FGR8XzmkvenHehKIIteBW+HpZ+fvNcRw6kcWbP9fwclXuQIsh8GC8ycKobTTuYfqKHCplPcbcbNMuNqChIwWycXez7uCxUnqOXLA+innUwTFmItLeWxyM0AY3MVk44a1MWiMY/9yOPa2wJKFO+MRE6gMedmShtLsGrnvb/OxXilDbfetM56XoyWSi4Hb0bxnO2N5N+Oi3/XSOCcbX08rJzBxaRQbQrWkZxSp1AaWKRoC1CU8fY6UU96nPHjcL/a772Hi9Q5512Dp2C+XoBscE6Y75ph1tjzsdEXVx66PzGJNXvupduPE9s2bmgeVmIWF7tD/4KZO22GKI43UXqhOLpehlpJhJ1T5/dDR/stN9gvGmi6ckFj+nEzM/RKgFt+SZq9uzdGcKD85w+JcWBS9e15E7+zdz3cCEsontbxo6nT9rGuxnpJpJuXOnzbqYff5YVDgDG5qsjKPrzfOMVPjmXmNZZJ1wCHpx68M/DLqNh4RPTbvZM0eMn93ycscxHt4XZ6CUZn1snG76tJS0xiWU3b+lBqwPEWrBLQn29eT7KZex7cgZQv29CPTx4G8Ld/LivG0cOpHFn65pj9Xi4hQ+4WJi+5uV3w+vNT1Gfn0Nss+YVLlGpfRAadwdjtiE+tfXTJl66xGw5C8Q2tIU95SUbdHvAbN48Zr3bel3CpoPKXt8fqFg8SwaURcUGMGPHVC1bzN+YaZS0onWh3jUgtsSGejD5e0i6dIkhBYRAfxvQg/+MKA5U1ce4O5P13H09DlXD1EoTkxvI6yHVpnMiYRpJkotTaTB2B8n9xmxTphmLI/bZprMkJP7jO1R0uRlaAtjdcRPNXZJdGcTaZeFUrYUvUKienA5nDpQejRdHhar8a+daH2IUAu1BqtF8efrOvDXGzuxev8Jhr/xKx8s30dufg2u1SiUjT3l7tAqExFbvWHIM2W/xu5Tz77LrHQz+BmTUz5qqklTLKvN7ICHTFrcsY1FLZWyCCxWRp7wqbFW2pdQYFRR7EtyOQkRaqHWMaFvLD89Opj+LcP428KdjPzPbyzelox28rp1QgWJ7W9S9LZ/B/2nODzc0rAL9amDpkzdnpnh4QW3TYc7viv9tY17OFIaW1xe+nGFCYhyNGZKTzLVjF3GXtzfpDLYi16chAi1UCtpEurHR3f24oMJPcgv0Nz7eQI3vreSX3aliGC7mtgBppOgf6Rpl1oefqFmVXS/cBMhF6e8dgLDXzKRd2z/io2vcGOmX/5u62PyQMVeW+Y5JT1PEEpkRMeGDG0Xydz1R/jPkj1MnLaOFhH+jO8Ty+juMQT7eZZ/EqF6ie1nIswr/mIyPyrC9e+YMvSKHl+YmJ4m8q4ogQ1NRknyVtg4A/rcByFNKn/dwgREGKHW+tIac5WCCLVQ6/GwWri1VxNu6NaIhVuO8fnvh/jr/O288eMuXry+I7f0iHF9k6f6hE8wPLGncoJVkwU+9rzn7x82jaQGPn7p5/SPNEupnT9zcXFONSDWh1Bn8PawclO3GObeP4AFD11GXEwwT83ezJSZG0g/l+vq4dUv3PmD0d7570i8sVrKyxSpCBeKXpxjf4hQC3WSjo2CmT6pL09e2ZYftiZz1VvLeW3RTtYeOEmeZInUb+yTm37hpslUtZzTVkbuJKEW60Oos1gtigcub0X/lmH8c9EuPly+n//+so8QP08eH9GW8b2bYpGimfpHg+amZenQPzn6VF8qFxa5FaEWhCrRrWkDZk7uy9lss1DB56sP8cK3W/lhyzFeG9WZJqF+rh6iUJP4hcKT+6pPpEGsD0GoLgJ9PLmqUzRf3N2Hv98cx+akdK58azmr9tbT3tf1meoUaTDirywi1IJQXSilGNu7KYsfHURMA1/++EUC+1JLaCQvCBXFXkbuJOtDhFqotzQO8eXjO3vhabUw6dN4TmfluHpIQm3GiUUv4lEL9ZomoX78b0IPxn24hj9+kcCVHRuy9sBJNiSepnEDXwa1jmBQm3C6xITIxKNQNvaiFycgEbVQ7+nZLJR/jIpj9f6T/OX77WxOSqdX81By8wt4a8lubvq/VYx4aznfbjgiqX1C6fhHOlYrr2YkohYE4ObuMbSMCCAswIuYBo4skBMZ51m2K5UPl+/nkVkb+c+SPQxqHY6n1YKnh4XLWoUzoFUpSzQJ9YvWV0BQKavAXCLKGQ1sevbsqePj46v9vILgKgoKND9uT+a/v+7n0IlMcvMKOJ9XQL7WPDGiLfcPaSll6sIloZRK0Fr3LGmfRNSCUAEsFsVVnaK5qpMjYsrOzefpOZv51+Jd7Ew+yz9HdcbXy+rCUQp1lQp71Eopq1Jqg1JqvjMHJAi1BR9PK2+N6crTV7Vj/uaj3P7xGs7l5Lt6WEIdpDKTiQ8DO8o9ShDqEUop7hvSknfHdmd94immzNwgE45CtVMhoVZKxQDXAB85dziCUDu5pnM0L13XkZ93HOfFedtk8QKhWqmoR/0W8BRQha7eglA/uLN/M5LPZPPfX/YR5u/Fo1e0kQlGoVooN6JWSl0LpGitE8o5brJSKl4pFZ+a6rxFHgXBnXnqyraM7hHD20v3MnHaOlLOZrt6SEIdoNz0PKXU34EJQB7gAwQBc7XWt5f2GknPE+ozWmu+WJPIK/O34+/twYOXt8Lb00J2bgENg3wYGddQIm3hIspKz6tUHrVSagjwhNb62rKOE6EWBNibcpaHZm5k+7EzRbZP7N+MP1/bQUrShSJIHrUguIBWkYF8P+Uyjp4+h5eHBR8PK+8s3cNHKw5wNjuP10bFoZRic9JpDp3I4sqODSUPWyiRSgm11voX4BenjEQQ6iBWiyqyMMGfrmlPoI8nb/68mx3HznAs/Rynssx6jo2CfXjumvZcExct1ohQBImoBaEGUUrx8PDWBPt68PnqQ1zeLpIhbSMJ8fXkHz/s5MEZG/i02UFu7h7DoDYRNA7x5VRmDr/vP8HOY2e4qXsMzcP9XX0bQg0jvT4EwU3IL9DMWneYd5fu4Wi6yRaJDvYh+Uw29j/TUH8vpk7sRdcmIS4cqeAMqm0ysaKIUAtC1dFaszclg193p7Lh8GnaRgUyoFUYwb6e3PXJOk5k5PDf23swuE2Eq4cqVCMi1IJQR0g5m83EqevYffwsz41sz8T+zSR7pI5QllDLwgGCUIuIDPRh1r19Gdwmgpfnb2fsh6s5fDLL1cMSnIwItSDUMgJ9PPnozp78c3Rnth89w5VvLef7TUddPSzBiYhQC0ItRCnFrT2bsOjRQXRsFMRDX27gy7WJrh6W4CREqAWhFtM4xJfP/tCHQa0jeGbuFj76bb+rhyQ4ARFqQajl+HpZ+eCOHlzdqSGvLNjBw19uYO2Bk9JqtQ4hBS+CUAfw9rDyzthu/HPxLmasSeS7jUdpEe5P16YhWJXCalF0b9qA0T1iJEukFiLpeYJQx8jKyWPB5mPMTkgi6dQ5CrQmJ6+AE5k5XNYqnNdGd6ZxiK+rhykUQ/KoBaGeo7VmxtpEXl2wA6tSPDaiDTd3iyHYz9PVQxNsiFALggBA4oksnpqzidX7T+LlYeGK9lHc0jOGwW0iijSCSjmbze7kDHo2a4CPp3T0qwmkzakgCAA0DfNj5j192Xb0DLMTkpi36SgLthyjXcNA7hvSko6Ngvl4xQHmrE8iJ6+AIB8Pru3SiFt6xNCtaQNXD7/eIhG1INRjcvIKmLfpKP/9ZS/7UjMB8PKwMLpHDINah7N423EWbU3mXG4+E/s349mR7fD2kAjbGYj1IQhCmRQUaH7cfpyDJzK5uXtjIgN9LuzLOJ/Hv3/cxbSVB+kSE8y747oX6bEtVA8i1IIgXDKLtibz5OxNADwxoi3j+zTFw2pBa83SnSl8sfoQ4/vEMrxDlItHWjsRoRYEoVpIPJHFM3M3s2rfCdpGBTJpYHO+Tkhi7QEzOZmTV8AfBjTn6avbikVSSaR7niAI1ULTMD+mT+rD+7d3JzMnjydnb2Z/aiZ/vbETG164gon9mzF15QFG//d39qacdfVw6wwSUQuCUCWyc/NZe+AkPWIb4O/tSCBbvC2Zp2ZvJisnj3sGtmDK0NayaG8FkIhaEIRqx8fTyqA2EUVEGuDKjg1Z8vhgruvSiP/7ZR/D3/iVX3aluGiUdQMRakEQqp3wAG/euLUrX07ui6+XlYnT1vHk15tIP5d70bEH0jJ54dutvPnTbs7n5RfZl1+gL9pWHxHrQxAEp5Kdm8/bS/bw/q/7iAj05ubuMTQK9iE8wJvF25KZt+koHhYLOfkFdGwUxNtjuxEb6sfc9Ud4e+kevDws/PDwwDo/OSlZH4IguJzNSad54dutbDt6hrwCozu+nlYm9Itl0sDmbDqczlOzN5GdW0BEoDeJJ7NoGeHPvtRMXri2A3df1tzFd+BcRKgFQXAbCgo0aZnnOZ5+niahvoT4eV3Yl5yezdNzNnMqK4cpQ1szvH0kd0xdy5Yj6fz65OUE+9bdJlIi1IIg1Fq2HU3n2ndWcO+gljxzdTtXD8dpSFMmQRBqLR0bBXNTt8ZMXXmACf1iiQz0Zu2Bk6w/dIrT53JJP5eLVSlu6t6YPs1Di3QBrCuIUAuC4PY8PqIt8zcf486pa0k9e/5C9oifl5UQX0/Ons9jVvxh2kYFcmf/Zozq0bhOTT6KUAuC4PY0DvHlgSGt+PT3gwxrF8mIjg0Z1CYcPy8jYdm5+czbeJRPVh3kuW+28N6yvTw0rBU3d4/B01r7s5DFoxYEoc6gtWbF3jRe/3E3mw6fplmYH/8c3YXezUMvHHM+L5/F244TEeBNt6YhbrMwgkwmCoJQr9Bas2RHCn9dsJ3DJ7N4eFgbHhzairUHTvL8t1su9N72tCo6x4TwyPDWDGwd4dIxX5JQK6V8gOWAN8Yqma21frGs14hQC4LgDmScz+P5b7bw7cajxIb5cehEFk1CffnztR2xWmDNgZP8uO04iSezeOn6jkzoG1vieVLPnsfLanHqGpOXKtQK8NdaZyilPIEVwMNa69WlvUaEWhAEd0FrzZz1R/j3j7sY1T2GB4e2KmJ3ZJzP46GZG1i6M4W7BjTjuZHtL/jaR06f492le/g6PglvDwv3DGrBPQNbXNTfpDqoNutDKeWHEer7tNZrSjtOhFoQhNpEfoHm1QU7mLryAB4WReMGvkQH+7D+0GkAxvRqQlrGeX7Ymkx4gBd/uqY9N3WLqdYxXHIetVLKCiQArYD3ShJppdRkYDJA06ZNqz5aQRCEGsZqUfz5ug4MaBXG+sRTHDqRxeFT5xjdM4YHLm9F4xBfANYnnuLVBTt4dNYmDqZl8cjw1hfyto+ePsfWI+mM6Niw2sdX2Yg6BPgGmKK13lracRJRC4JQV8nNL+C5uVv4OiGJMT2bMHlwCz5cvp8565Pw8/JgzXPDqpRJUm2ViVrr00qpZcBVQKlCLQiCUFfxtFr45+jONAz24Z2le5kVfxgvDwtjezdl8qAWTkn3K1eolVIRQK5NpH2BK4DXqn0kgiAItQSlFI+PaEuzMH/2p2VwZ79mRAb5lP/CKlKRiDoa+NTmU1uAr7TW8502IkEQhFrCqB7VO6FYGuUKtdZ6M9CtBsYiCIIglEDtL4IXBEGo44hQC4IguDki1IIgCG6OCLUgCIKbI0ItCILg5ohQC4IguDki1IIgCG6OUxYOUEqlAoeq+PJwIK0ah1MbqI/3DPXzvuvjPUP9vO/K3nOs1rrE1QucItSXglIqvrTGJHWV+njPUD/vuz7eM9TP+67OexbrQxAEwc0RoRYEQXBz3FGoP3D1AFxAfbxnqJ/3xFCoqAAAA6hJREFUXR/vGernfVfbPbudRy0IgiAUxR0jakEQBKEQItSCIAhujtsItVLqKqXULqXUXqXUM64ej7NQSjVRSi1TSm1XSm1TSj1s2x6qlPpJKbXH9tjA1WOtbpRSVqXUBqXUfNvz5kqpNbb3fJZSysvVY6xulFIhSqnZSqmdSqkdSql+df29Vko9avvd3qqUmqmU8qmL77VSaqpSKkUptbXQthLfW2V423b/m5VS3StzLbcQatvqMe8BVwMdgLFKqQ6uHZXTyAMe11p3APoCD9ju9Rlgida6NbDE9ryu8TCwo9Dz14A3tdatgFPA3S4ZlXP5D7BIa90O6IK5/zr7XiulGgMPAT211p0AK3AbdfO9/gSzfmxhSntvrwZa2/5NBv5bqStprV3+D+gHLC70/FngWVePq4bu/TvMOpS7gGjbtmhgl6vHVs33GWP7xR0KzAcUpmrLo6TfgbrwDwgGDmCbtC+0vc6+10Bj4DAQillBaj5wZV19r4FmwNby3lvgf8DYko6ryD+3iKhxvLl2kmzb6jRKqWaYZc7WAFFa62O2XclAlIuG5SzeAp4CCmzPw4DTWus82/O6+J43B1KBaTbL5yOllD91+L3WWh8BXgcSgWNAOpBA3X+v7ZT23l6SxrmLUNc7lFIBwBzgEa31mcL7tPnIrTN5k0qpa4EUrXWCq8dSw3gA3YH/aq27AZkUsznq4HvdALgB8yHVCPDnYnugXlCd7627CPURoEmh5zG2bXUSpZQnRqSna63n2jYfV0pF2/ZHAymuGp8TGABcr5Q6CHyJsT/+A4QopewLLNfF9zwJSNJar7E9n40R7rr8Xg8HDmitU7XWucBczPtf199rO6W9t5ekce4i1OuA1raZYS/M5MM8F4/JKSilFPAxsENr/UahXfOAO20/34nxrusEWutntdYxWutmmPd2qdZ6PLAMGG07rE7dM4DWOhk4rJRqa9s0DNhOHX6vMZZHX6WUn+133X7Pdfq9LkRp7+084A5b9kdfIL2QRVI+rjbjC5nrI4HdwD7gT64ejxPv8zLM16HNwEbbv5EYz3YJsAf4GQh19ViddP9DgPm2n1sAa4G9wNeAt6vH54T77QrE297vb4EGdf29Bv4C7AS2Ap8D3nXxvQZmYnz4XMy3p7tLe28xk+fv2fRtCyYrpsLXkhJyQRAEN8ddrA9BEAShFESoBUEQ3BwRakEQBDdHhFoQBMHNEaEWBEFwc0SoBUEQ3BwRakEQBDfn/wFFJur+GquSRQAAAABJRU5ErkJggg==\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"needs_background":"light"}},{"output_type":"stream","name":"stdout","text":["loss =  2.9698166847229004 , val_loss =  4.169402122497559\n","\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r257/257 [==============================] - 277s 1s/step - loss: 2.9698 - dense_686_loss: 0.2464 - dense_689_loss: 0.1867 - dense_692_loss: 0.2552 - dense_695_loss: 0.2985 - dense_698_loss: 0.2990 - dense_701_loss: 0.2962 - dense_704_loss: 0.2115 - dense_707_loss: 0.1723 - dense_710_loss: 0.2858 - dense_713_loss: 0.3172 - dense_716_loss: 0.1714 - dense_719_loss: 0.2296 - dense_686_accuracy: 0.8972 - dense_689_accuracy: 0.9346 - dense_692_accuracy: 0.8889 - dense_695_accuracy: 0.8656 - dense_698_accuracy: 0.8754 - dense_701_accuracy: 0.8682 - dense_704_accuracy: 0.9271 - dense_707_accuracy: 0.9361 - dense_710_accuracy: 0.8761 - dense_713_accuracy: 0.8525 - dense_716_accuracy: 0.9357 - dense_719_accuracy: 0.9164 - val_loss: 4.1694 - val_dense_686_loss: 0.2932 - val_dense_689_loss: 0.3398 - val_dense_692_loss: 0.3912 - val_dense_695_loss: 0.3767 - val_dense_698_loss: 0.3895 - val_dense_701_loss: 0.4099 - val_dense_704_loss: 0.3789 - val_dense_707_loss: 0.3391 - val_dense_710_loss: 0.3597 - val_dense_713_loss: 0.3779 - val_dense_716_loss: 0.2432 - val_dense_719_loss: 0.2702 - val_dense_686_accuracy: 0.8694 - val_dense_689_accuracy: 0.8618 - val_dense_692_accuracy: 0.8229 - val_dense_695_accuracy: 0.8229 - val_dense_698_accuracy: 0.8171 - val_dense_701_accuracy: 0.8159 - val_dense_704_accuracy: 0.8318 - val_dense_707_accuracy: 0.8447 - val_dense_710_accuracy: 0.8288 - val_dense_713_accuracy: 0.8259 - val_dense_716_accuracy: 0.9018 - val_dense_719_accuracy: 0.8771\n"]}],"source":["history = model.fit(train_generator,validation_data = valid_generator, epochs=100,verbose=1,callbacks=callbacks)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iUi69BrvPvTu"},"outputs":[],"source":["# copy from https://gist.github.com/stared/dfb4dfaf6d9a8501cd1cc8b8cb806d2e\n","# loss 실시간 출력 \n","from IPython.display import clear_output\n","from tensorflow.keras.callbacks import Callback\n","\n","class PlotLosses(Callback):\n","\n","  def on_train_begin(self, logs={}):\n","    self.epochs = []\n","    self.losses = []\n","    self.val_losses = []\n","    self.logs = []\n","    self.fig = plt.figure()\n","\n","\n","  def on_epoch_end(self, epoch, logs={}):\n","\n","    self.epochs.append(epoch)\n","    self.losses.append(logs.get('loss'))\n","    self.val_losses.append(logs.get('val_loss'))\n","\n","    clear_output(wait=True)\n","    plt.plot(self.epochs, self.losses, label=\"loss\")\n","    plt.plot(self.epochs, self.val_losses, label=\"val_loss\")\n","    plt.legend()\n","    plt.show();\n","    print(\"loss = \", self.losses[-1], \", val_loss = \", self.val_losses[-1])\n","\n","#call backs 선언\n","plot_losses = PlotLosses()\n","\n","from tensorflow.keras.callbacks import ModelCheckpoint #<- model 저장 객체, best_model.h5라는 모델 이 저장 됨 \n","model_check_point = ModelCheckpoint(\n","    'best_model.h5', \n","    monitor='val_loss', \n","    verbose=1, \n","    save_best_only=True)\n","\n","\n","from tensorflow.keras.callbacks import EarlyStopping\n","early_stopping = EarlyStopping(\n","    monitor='val_loss',  # 모니터링 대상, 이걸 기준으로 멈춤 \n","    verbose=1,\n","    patience=50)         # 중지까지의 여유분\n","\n","from tensorflow.keras.callbacks import ReduceLROnPlateau\n","reduce_lr = ReduceLROnPlateau(\n","    monitor='val_loss', # 모니터링 대상\n","    patience=5,        # 대상ㅃ 기간동안 유지\n","    factor=0.2,         # 줄이는 양                              \n","    min_learning_rate=0.00001)     # 최소 학습율\n","\n","callbacks = [ plot_losses]"]},{"cell_type":"markdown","source":["#예측 및 평가 -> voting "],"metadata":{"id":"YrKmVZ3ErIyF"}},{"cell_type":"code","source":["y_ = model.predict(test_generator)"],"metadata":{"id":"GPJ6DeFKxQh1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for i in range(12):\n","  exec(f'predicted_{i} = np.argmax(y_[{i}],axis=1)')"],"metadata":{"id":"lj9IUxcTxy4M"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["target_0 = np.array(csvs[output_columns][valid:])[:,0]\n"],"metadata":{"id":"abplTWCSyT37"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["temp = pd.DataFrame([predicted_0,predicted_1,predicted_2,predicted_3,predicted_4,predicted_5,predicted_6,predicted_7,predicted_8,predicted_9,predicted_10,predicted_11]).T\n","temp['index']=0"],"metadata":{"id":"mVYwKRL5yu2A"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for i in range(321):\n","  temp['index'].iloc[i*17:(i+1)*17] = i "],"metadata":{"id":"uFLp5gKj0J2h"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["round(np.mean(temp[temp['index']==0][0]))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VKwBNeo51t_a","executionInfo":{"status":"ok","timestamp":1645238372631,"user_tz":-540,"elapsed":514,"user":{"displayName":"­임훈","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"15355961264808837253"}},"outputId":"b43d48bd-8101-403c-a263-4eaa740edaa2"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0"]},"metadata":{},"execution_count":460}]},{"cell_type":"code","source":["temp[temp['index']==0]"],"metadata":{"id":"X6G9s42u2l5b"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["np.round(np.mean(np.array(temp[temp['index']==0]),axis=0))[:-1]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8Cy6sMSW2tww","executionInfo":{"status":"ok","timestamp":1645238567463,"user_tz":-540,"elapsed":383,"user":{"displayName":"­임훈","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"15355961264808837253"}},"outputId":"84a1109f-921a-4bd5-b002-0cd2c89f1411"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0., 0., 0., 1., 0., 0., 0., 1., 0., 1., 0., 0.])"]},"metadata":{},"execution_count":476}]},{"cell_type":"code","source":["predicted_y = pd.DataFrame(np.zeros(321*12).reshape(321,12))"],"metadata":{"id":"ZQgVlP_O2LRc"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for i in range(321):\n","  predicted_y.iloc[i,:] = np.round(np.mean(np.array(temp[temp['index']==i]),axis=0))[:-1]"],"metadata":{"id":"1miX5gl-2_YR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["predicted_y"],"metadata":{"id":"3q8edMHT3I6Z"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["test_y = csvs[valid:]\n","test_y = test_y.reset_index().drop(columns = 'index')\n","test_y.drop_duplicates(['성명'],keep='first')\n","test_y = np.array(test_y[output_columns])"],"metadata":{"id":"4PqAh7Ag3haj"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"-eCOzifk344h"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from sklearn.metrics import precision_recall_fscore_support, classification_report,accuracy_score"],"metadata":{"id":"AN7CeZm24oNn"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(classification_report(test_y,np.array(predicted_y),target_names = ['0','1','2','3','4','5','6','7','8','9','10','11']))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HxPmZnLU6kMI","executionInfo":{"status":"ok","timestamp":1645239586384,"user_tz":-540,"elapsed":394,"user":{"displayName":"­임훈","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"15355961264808837253"}},"outputId":"2d363f4b-5503-40cc-f7b1-5585bf2a067a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","           0       0.69      0.53      0.60       174\n","           1       0.54      0.35      0.42       130\n","           2       0.59      0.22      0.32       169\n","           3       0.57      0.55      0.56       164\n","           4       0.58      0.42      0.49       154\n","           5       0.58      0.54      0.56       158\n","           6       0.63      0.17      0.26       133\n","           7       0.74      0.86      0.80       235\n","           8       0.66      0.59      0.63       190\n","           9       0.61      0.62      0.61       165\n","          10       0.67      0.06      0.12       124\n","          11       0.71      0.32      0.44       111\n","\n","   micro avg       0.64      0.47      0.54      1907\n","   macro avg       0.63      0.44      0.48      1907\n","weighted avg       0.63      0.47      0.51      1907\n"," samples avg       0.61      0.48      0.47      1907\n","\n"]}]},{"cell_type":"code","source":["score = precision_recall_fscore_support(test_y,np.array(predicted_y))\n","score = pd.DataFrame([score[0],score[1],score[2]])\n","score.index = ['precision','recall','f1score']\n","score['average']=0\n","for i in range(3):\n","  score['average'].iloc[i] = np.mean(np.array(score)[i,:])\n","score"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":143},"id":"3ih8lTgf58BG","executionInfo":{"status":"ok","timestamp":1645239442808,"user_tz":-540,"elapsed":9,"user":{"displayName":"­임훈","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"15355961264808837253"}},"outputId":"b64d1e26-338a-4106-fd85-241437ca7c71"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["\n","  <div id=\"df-9421066c-cef7-422f-86f4-dbbcb5274924\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>0</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>9</th>\n","      <th>10</th>\n","      <th>11</th>\n","      <th>average</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>precision</th>\n","      <td>0.686567</td>\n","      <td>0.535714</td>\n","      <td>0.587302</td>\n","      <td>0.573248</td>\n","      <td>0.580357</td>\n","      <td>0.582192</td>\n","      <td>0.628571</td>\n","      <td>0.743590</td>\n","      <td>0.660819</td>\n","      <td>0.605882</td>\n","      <td>0.666667</td>\n","      <td>0.705882</td>\n","      <td>0.581292</td>\n","    </tr>\n","    <tr>\n","      <th>recall</th>\n","      <td>0.528736</td>\n","      <td>0.346154</td>\n","      <td>0.218935</td>\n","      <td>0.548780</td>\n","      <td>0.422078</td>\n","      <td>0.537975</td>\n","      <td>0.165414</td>\n","      <td>0.863830</td>\n","      <td>0.594737</td>\n","      <td>0.624242</td>\n","      <td>0.064516</td>\n","      <td>0.324324</td>\n","      <td>0.403055</td>\n","    </tr>\n","    <tr>\n","      <th>f1score</th>\n","      <td>0.597403</td>\n","      <td>0.420561</td>\n","      <td>0.318966</td>\n","      <td>0.560748</td>\n","      <td>0.488722</td>\n","      <td>0.559211</td>\n","      <td>0.261905</td>\n","      <td>0.799213</td>\n","      <td>0.626039</td>\n","      <td>0.614925</td>\n","      <td>0.117647</td>\n","      <td>0.444444</td>\n","      <td>0.446906</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9421066c-cef7-422f-86f4-dbbcb5274924')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9421066c-cef7-422f-86f4-dbbcb5274924 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9421066c-cef7-422f-86f4-dbbcb5274924');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["                  0         1         2  ...        10        11   average\n","precision  0.686567  0.535714  0.587302  ...  0.666667  0.705882  0.581292\n","recall     0.528736  0.346154  0.218935  ...  0.064516  0.324324  0.403055\n","f1score    0.597403  0.420561  0.318966  ...  0.117647  0.444444  0.446906\n","\n","[3 rows x 13 columns]"]},"metadata":{},"execution_count":555}]},{"cell_type":"code","source":["acc = accuracy_score(test_y.reshape(321*12,),np.array(predicted_y).reshape(-1,))\n","print(f'accuracy = {acc}')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"x1GSGzuF7QNY","executionInfo":{"status":"ok","timestamp":1645239773357,"user_tz":-540,"elapsed":410,"user":{"displayName":"­임훈","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"15355961264808837253"}},"outputId":"37b31018-2a97-40ec-f98c-4c2f2f38753e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["accuracy = 0.6061786085150571\n"]}]}],"metadata":{"accelerator":"GPU","colab":{"background_execution":"on","collapsed_sections":[],"machine_shape":"hm","name":"22.02.19_model_1","provenance":[{"file_id":"1pZwwDcy03Jj_dM6dOU7Gi59mctIiJPVo","timestamp":1645266574968},{"file_id":"18tastMh4sxkdMSRQ3ShsNVmFNnRdzc2e","timestamp":1644885200151}],"toc_visible":true,"mount_file_id":"1pZwwDcy03Jj_dM6dOU7Gi59mctIiJPVo","authorship_tag":"ABX9TyONByLdk0wqC4GlT0B2dxbp"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}